/*
 * $Id: Imakefile,v 1.12 1999-09-02 14:46:54 ghudson Exp $
 */

#define ISUBDIRS doc

OBJS= track.o y.tab.o stamp.o except.o files.o misc.o update.o cksum.o
LIBS= $(OSLIBS)

/* This is really gross.  Solaris 2.5.1 bumps the version number on
 * libresolv, so anything built with -lresolv doesn't work during the
 * update.  We put -lresolv in LDLIBS in the Athena imake templates so
 * that programs using Hesiod can be built.  Take it out for track, so
 * that we can run track during the update. */
#ifdef SOLARIS
LDLIBS=-lsocket -lnsl -lelf -ldl
#endif

#ifdef _AUX_SOURCE
OSLIBS= -lc -lPW
#endif
#ifdef SOLARIS
OSLIBS= -ladm -lmail -lbsd
#endif

create_dir($(ATHETCDIR))
SimpleProgram(track,$(OBJS),$(LIBS),$(ATHETCDIR))

y.tab.c : sub_gram.y 
	yacc sub_gram.y 
	sed -e 's/char linebuf\[1024\]/char linebuf[2048]/' y.tab.c > y.tab.c1
	rm -f y.tab.c
	mv y.tab.c1 y.tab.c

y.tab.o : y.tab.c lex.yy.c track.h

lex.yy.c : input.l
	@echo IGNORE FIVE "Non-Portable Character Class" WARNINGS --
	lex input.l

clean::
	$(RM) a.out core *.o *~ y.tab.c lex.yy.c 
